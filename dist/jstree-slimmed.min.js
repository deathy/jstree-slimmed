/*! jsTree-slimmed - v3.3.17-slimmed - 2025-03-07 - (MIT) */

!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(v,y){"use strict";if(!v.jstree){var s=0,n=!1,a=!1,d=!1,r=[],e=v("script:last").attr("src"),x=window.document,c=window.setImmediate,i=window.Promise;!c&&i&&(c=function(e,t){i.resolve(t).then(e)}),v.jstree={version:"3.3.17-slimmed",defaults:{plugins:[]},plugins:{},path:e&&-1!==e.indexOf("/")?e.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},v.jstree.create=function(e,i){var r=new v.jstree.core(++s),t=i;return i=v.extend(!0,{},v.jstree.defaults,i),t&&t.plugins&&(i.plugins=t.plugins),v.each(i.plugins,function(e,t){"core"!==e&&(r=r.plugin(t,i[t]))}),v(e).data("jstree",r),r.init(e,i),r},v.jstree.destroy=function(){v(".jstree:jstree").jstree("destroy"),v(x).off(".jstree")},v.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},v.jstree.reference=function(t){var i=null,e=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!e||!e.length)try{e=v(t)}catch(e){}if(!e||!e.length)try{e=v("#"+t.replace(v.jstree.idregex,"\\$&"))}catch(e){}return e&&e.length&&(e=e.closest(".jstree")).length&&(e=e.data("jstree"))?i=e:v(".jstree").each(function(){var e=v(this).data("jstree");if(e&&e._model.data[t])return i=e,!1}),i},v.fn.jstree=function(i){var r="string"==typeof i,s=Array.prototype.slice.call(arguments,1),n=null;return!(!0===i&&!this.length)&&(this.each(function(){var e=v.jstree.reference(this),t=r&&e?e[i]:null;if(n=r&&t?t.apply(e,s):null,e||r||i!==y&&!v.isPlainObject(i)||v.jstree.create(this,i),null!==(n=e&&!r||!0===i?e||!1:n)&&n!==y)return!1}),null!==n&&n!==y?n:this)},v.expr.pseudos.jstree=v.expr.createPseudo(function(e){return function(e){return v(e).hasClass("jstree")&&v(e).data("jstree")!==y}}),v.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:v.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,compute_elements_positions:!1,keyboard:{"ctrl-space":function(e){e.type="click",v(e.currentTarget).trigger(e)},enter:function(e){e.type="click",v(e.currentTarget).trigger(e)},left:function(e){var e;e.preventDefault(),this.is_open(e.currentTarget)?this.close_node(e.currentTarget):(e=this.get_parent(e.currentTarget))&&e.id!==v.jstree.root&&this.get_node(e,!0).children(".jstree-anchor").trigger("focus")},up:function(e){e.preventDefault();var e=this.get_prev_dom(e.currentTarget);e&&e.length&&e.children(".jstree-anchor").trigger("focus")},right:function(e){var e;e.preventDefault(),this.is_closed(e.currentTarget)?this.open_node(e.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").trigger("focus")}):!this.is_open(e.currentTarget)||(e=this.get_node(e.currentTarget,!0).children(".jstree-children")[0])&&v(this._firstChild(e)).children(".jstree-anchor").trigger("focus")},down:function(e){e.preventDefault();var e=this.get_next_dom(e.currentTarget);e&&e.length&&e.children(".jstree-anchor").trigger("focus")},"*":function(e){this.open_all()},home:function(e){e.preventDefault();var e=this._firstChild(this.get_container_ul()[0]);e&&v(e).children(".jstree-anchor").filter(":visible").trigger("focus")},end:function(e){e.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().trigger("focus")},f2:function(e){e.preventDefault(),this.edit(e.currentTarget)}},allow_reselect:!1},v.jstree.core.prototype={plugin:function(e,t){var i=v.jstree.plugins[e];return i?(this._data[e]={},i.prototype=this,new i(t,this)):this},init:function(e,t){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[v.jstree.root]={id:v.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=v(e).addClass("jstree jstree-"+this._id),this.settings=t,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node(v.jstree.root)},destroy:function(e){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.teardown()},_create_prototype_node:function(){var e=x.createElement("LI"),t,i;return e.setAttribute("role","none"),(t=x.createElement("I")).className="jstree-icon jstree-ocl",t.setAttribute("role","presentation"),e.appendChild(t),(t=x.createElement("A")).className="jstree-anchor",t.setAttribute("href","#"),t.setAttribute("tabindex","-1"),t.setAttribute("role","treeitem"),(i=x.createElement("I")).className="jstree-icon jstree-themeicon",i.setAttribute("role","presentation"),t.appendChild(i),e.appendChild(t),t=i=null,e},_kbevent_to_func:function(e){var t={8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"},i=[];if(e.ctrlKey&&i.push("ctrl"),e.altKey&&i.push("alt"),e.shiftKey&&i.push("shift"),i.push(t[e.which]?t[e.which].toLowerCase():e.which),"shift-shift"===(i=i.sort().join("-").toLowerCase())||"ctrl-ctrl"===i||"alt-alt"===i)return null;var r=this.settings.core.keyboard,s,n;for(s in r)if(r.hasOwnProperty(s)&&(n="-"!==(n=s)&&"+"!==n?(n=n.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS")).split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase():n)===i)return r[s];return null},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var s="",n=null,t=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(x.selection&&x.selection.empty)x.selection.empty();else if(window.getSelection){var e=window.getSelection();try{e.removeAllRanges(),e.collapse()}catch(e){}}}).on("mousedown.jstree",function(e){e.target===this.element[0]&&(e.preventDefault(),t=+new Date)}.bind(this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",function(e){this.toggle_node(e.target)}.bind(this)).on("dblclick.jstree",".jstree-anchor",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this.settings.core.dblclick_toggle&&this.toggle_node(e.target)}.bind(this)).on("click.jstree",".jstree-anchor",function(e){e.preventDefault(),e.currentTarget!==x.activeElement&&v(e.currentTarget).trigger("focus"),this.activate_node(e.currentTarget,e)}.bind(this)).on("keydown.jstree",".jstree-anchor",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this._data.core.rtl&&(37===e.which?e.which=39:39===e.which&&(e.which=37));var t=this._kbevent_to_func(e);if(t){var e=t.call(this,e);if(!1===e||!0===e)return e}}.bind(this)).on("load_node.jstree",function(e,t){t.status&&(t.node.id!==v.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){for(var e=[],t,i,t=0,i=this._data.core.selected.length;t<i;t++)e=e.concat(this._model.data[this._data.core.selected[t]].parents);for(t=0,i=(e=v.vakata.array_unique(e)).length;t<i;t++)this.open_node(e[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}}.bind(this),0))}.bind(this)).on("keypress.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;n&&clearTimeout(n),n=setTimeout(function(){s=""},500);var i=String.fromCharCode(e.which).toLowerCase(),t=this.element.find(".jstree-anchor").filter(":visible"),e=t.index(x.activeElement)||0,r=!1;if(1<(s+=i).length){if(t.slice(e).each(function(e,t){if(0===v(t).text().toLowerCase().indexOf(s))return v(t).trigger("focus"),!(r=!0)}.bind(this)),r)return;if(t.slice(0,e).each(function(e,t){if(0===v(t).text().toLowerCase().indexOf(s))return v(t).trigger("focus"),!(r=!0)}.bind(this)),r)return}new RegExp("^"+i.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(s)&&(t.slice(e+1).each(function(e,t){if(v(t).text().toLowerCase().charAt(0)===i)return v(t).trigger("focus"),!(r=!0)}.bind(this)),r||t.slice(0,e+1).each(function(e,t){if(v(t).text().toLowerCase().charAt(0)===i)return v(t).trigger("focus"),!(r=!0)}.bind(this)))}.bind(this)).on("init.jstree",function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this._data.core.themes.ellipsis=e.ellipsis,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)}.bind(this)).on("loading.jstree",function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()}.bind(this)).on("blur.jstree",".jstree-anchor",function(e){this._data.core.focused=null,v(e.currentTarget).filter(".jstree-hovered").trigger("mouseleave"),this.element.attr("tabindex","0"),v(e.currentTarget).attr("tabindex","-1")}.bind(this)).on("focus.jstree",".jstree-anchor",function(e){var t=this.get_node(e.currentTarget);t&&(t.id||0===t.id)&&(this._data.core.focused=t.id),this.element.find(".jstree-hovered").not(e.currentTarget).trigger("mouseleave"),v(e.currentTarget).trigger("mouseenter"),this.element.attr("tabindex","-1"),v(e.currentTarget).attr("tabindex","0")}.bind(this)).on("focus.jstree",function(){var e;500<+new Date-t&&!this._data.core.focused&&this.settings.core.restore_focus&&(t=0,(e=this.get_node(this.element.attr("aria-activedescendant"),!0))&&e.find("> .jstree-anchor").trigger("focus"))}.bind(this)).on("mouseenter.jstree",".jstree-anchor",function(e){this.hover_node(e.currentTarget)}.bind(this)).on("mouseleave.jstree",".jstree-anchor",function(e){this.dehover_node(e.currentTarget)}.bind(this))},unbind:function(){this.element.off(".jstree"),v(x).off(".jstree-"+this._id)},trigger:function(e,t){((t=t||{}).instance=this).element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(e){var t=this.settings.core.strings;return v.vakata.is_function(t)?t.call(this,e):t&&t[e]?t[e]:e},_firstChild:function(e){e=e?e.firstChild:null;while(null!==e&&1!==e.nodeType)e=e.nextSibling;return e},_nextSibling:function(e){e=e?e.nextSibling:null;while(null!==e&&1!==e.nodeType)e=e.nextSibling;return e},_previousSibling:function(e){e=e?e.previousSibling:null;while(null!==e&&1!==e.nodeType)e=e.previousSibling;return e},get_node:function(e,t){var i;(e=e&&(e.id||0===e.id)?e.id:e)instanceof v&&e.length&&e[0].id&&(e=e[0].id);try{if(this._model.data[e])e=this._model.data[e];else if("string"==typeof e&&this._model.data[e.replace(/^#/,"")])e=this._model.data[e.replace(/^#/,"")];else if("string"==typeof e&&(i=v("#"+e.replace(v.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])e=this._model.data[i.closest(".jstree-node").attr("id")];else if((i=this.element.find(e)).length&&this._model.data[i.closest(".jstree-node").attr("id")])e=this._model.data[i.closest(".jstree-node").attr("id")];else{if(!(i=this.element.find(e)).length||!i.hasClass("jstree"))return!1;e=this._model.data[v.jstree.root]}return e=t?e.id===v.jstree.root?this.element:v("#"+e.id.replace(v.jstree.idregex,"\\$&"),this.element):e}catch(e){return!1}},get_path:function(e,t,i){if(!(e=e.parents?e:this.get_node(e))||e.id===v.jstree.root||!e.parents)return!1;var r,s,n=[];for(n.push(i?e.id:e.text),r=0,s=e.parents.length;r<s;r++)n.push(i?e.parents[r]:this.get_text(e.parents[r]));return n=n.reverse().slice(1),t?n.join(t):n},get_next_dom:function(e,t){var i;if((e=this.get_node(e,!0))[0]===this.element[0]){i=this._firstChild(this.get_container_ul()[0]);while(i&&0===i.offsetHeight)i=this._nextSibling(i);return!!i&&v(i)}if(!e||!e.length)return!1;if(t){i=e[0];do{i=this._nextSibling(i)}while(i&&0===i.offsetHeight);return!!i&&v(i)}if(e.hasClass("jstree-open")){i=this._firstChild(e.children(".jstree-children")[0]);while(i&&0===i.offsetHeight)i=this._nextSibling(i);if(null!==i)return v(i)}i=e[0];do{i=this._nextSibling(i)}while(i&&0===i.offsetHeight);return null!==i?v(i):e.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(e,t){var i;if((e=this.get_node(e,!0))[0]===this.element[0]){i=this.get_container_ul()[0].lastChild;while(i&&0===i.offsetHeight)i=this._previousSibling(i);return!!i&&v(i)}if(!e||!e.length)return!1;if(t){i=e[0];do{i=this._previousSibling(i)}while(i&&0===i.offsetHeight);return!!i&&v(i)}i=e[0];do{i=this._previousSibling(i)}while(i&&0===i.offsetHeight);if(null===i)return!(!(i=e[0].parentNode.parentNode)||!i.className||-1===i.className.indexOf("jstree-node"))&&v(i);e=v(i);while(e.hasClass("jstree-open"))e=e.children(".jstree-children").first().children(".jstree-node:visible:last");return e},get_parent:function(e){return!(!(e=this.get_node(e))||e.id===v.jstree.root)&&e.parent},get_children_dom:function(e){return(e=this.get_node(e,!0))[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return(e=this.get_node(e))&&(!1===e.state.loaded||0<e.children.length)},is_loaded:function(e){return(e=this.get_node(e))&&e.state.loaded},is_loading:function(e){return(e=this.get_node(e))&&e.state&&e.state.loading},is_open:function(e){return(e=this.get_node(e))&&e.state.opened},is_closed:function(e){return(e=this.get_node(e))&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(a,d){var e=this.get_node(a,!0),t,i,r,s,n;if(v.vakata.is_array(a))return this._load_nodes(a.slice(),d),!0;if(!(a=this.get_node(a)))return d&&d.call(this,a,!1),!1;if(a.state.loaded){for(a.state.loaded=!1,r=0,s=a.parents.length;r<s;r++)this._model.data[a.parents[r]].children_d=v.vakata.array_filter(this._model.data[a.parents[r]].children_d,function(e){return-1===v.inArray(e,a.children_d)});for(t=0,i=a.children_d.length;t<i;t++)this._model.data[a.children_d[t]].state.selected&&(n=!0),delete this._model.data[a.children_d[t]];n&&(this._data.core.selected=v.vakata.array_filter(this._data.core.selected,function(e){return-1===v.inArray(e,a.children_d)})),a.children=[],a.children_d=[],n&&this.trigger("changed",{action:"load_node",node:a,selected:this._data.core.selected})}return a.state.failed=!1,a.state.loading=!0,(a.id!==v.jstree.root?e.children(".jstree-anchor"):e).attr("aria-busy",!0),e.addClass("jstree-loading"),this._load_node(a,function(e){(a=this._model.data[a.id]).state.loading=!1,a.state.loaded=e,a.state.failed=!a.state.loaded;for(var t=this.get_node(a,!0),i=0,r=0,s=this._model.data,n=!1,i=0,r=a.children.length;i<r;i++)if(s[a.children[i]]&&!s[a.children[i]].state.hidden){n=!0;break}a.state.loaded&&t&&t.length&&(t.removeClass("jstree-closed jstree-open jstree-leaf"),n?"#"!==a.id&&t.addClass(a.state.opened?"jstree-open":"jstree-closed"):t.addClass("jstree-leaf")),(a.id!==v.jstree.root?t.children(".jstree-anchor"):t).attr("aria-busy",!1),t.removeClass("jstree-loading"),this.trigger("load_node",{node:a,status:e}),d&&d.call(this,a,e)}.bind(this)),!0},_load_nodes:function(e,t,i,r){for(var s=!0,n=function(){this._load_nodes(e,t,!0)},a=this._model.data,d,o,c=[],d=0,o=e.length;d<o;d++)a[e[d]]&&(!a[e[d]].state.loaded&&!a[e[d]].state.failed||!i&&r)&&(this.is_loading(e[d])||this.load_node(e[d],n),s=!1);if(s){for(d=0,o=e.length;d<o;d++)a[e[d]]&&a[e[d]].state.loaded&&c.push(e[d]);t&&!t.done&&(t.call(this,c),t.done=!0)}},load_all:function(e,t){if(e=e||v.jstree.root,!(e=this.get_node(e)))return!1;var i=[],r=this._model.data,s=r[e.id].children_d,n,a;for(e.state&&!e.state.loaded&&i.push(e.id),n=0,a=s.length;n<a;n++)r[s[n]]&&r[s[n]].state&&!r[s[n]].state.loaded&&i.push(s[n]);i.length?this._load_nodes(i,function(){this.load_all(e,t)}):(t&&t.call(this,e),this.trigger("load_all",{node:e}))},_load_node:function(s,n){var e=this.settings.core.data,t,a=function e(){return 3!==this.nodeType&&8!==this.nodeType};return e?v.vakata.is_function(e)?e.call(this,s,function(e){!1===e?n.call(this,!1):this["string"==typeof e?"_append_html_data":"_append_json_data"](s,"string"==typeof e?v(v.parseHTML(e)).filter(a):e,function(e){n.call(this,e)})}.bind(this)):"object"==typeof e?e.url?(e=v.extend(!0,{},e),v.vakata.is_function(e.url)&&(e.url=e.url.call(this,s)),v.vakata.is_function(e.data)&&(e.data=e.data.call(this,s)),v.ajax(e).done(function(e,t,i){var r=i.getResponseHeader("Content-Type");return r&&-1!==r.indexOf("json")||"object"==typeof e?this._append_json_data(s,e,function(e){n.call(this,e)}):r&&-1!==r.indexOf("html")||"string"==typeof e?this._append_html_data(s,v(v.parseHTML(e)).filter(a),function(e){n.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:s.id,xhr:i})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))}.bind(this)).fail(function(e){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:s.id,xhr:e})},n.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)}.bind(this))):(t=v.vakata.is_array(e)?v.extend(!0,[],e):v.isPlainObject(e)?v.extend(!0,{},e):e,s.id===v.jstree.root?this._append_json_data(s,t,function(e){n.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:s.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))):"string"==typeof e?s.id===v.jstree.root?this._append_html_data(s,v(v.parseHTML(e)).filter(a),function(e){n.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:s.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1)):n.call(this,!1):s.id===v.jstree.root?this._append_html_data(s,this._data.core.original_container_html.clone(!0),function(e){n.call(this,e)}):n.call(this,!1)},_node_changed:function(e){(e=this.get_node(e))&&-1===v.inArray(e.id,this._model.changed)&&this._model.changed.push(e.id)},_append_html_data:function(e,t,i){(e=this.get_node(e)).children=[],e.children_d=[];var t=t.is("ul")?t.children():t,r=e.id,s=[],n=[],a=this._model.data,d=a[r],e=this._data.core.selected.length,o,c,l;for(t.each(function(e,t){(o=this._parse_model_from_html(v(t),r,d.parents.concat()))&&(s.push(o),n.push(o),a[o].children_d.length&&(n=n.concat(a[o].children_d)))}.bind(this)),d.children=s,d.children_d=n,c=0,l=d.parents.length;c<l;c++)a[d.parents[c]].children_d=a[d.parents[c]].children_d.concat(n);this.trigger("model",{nodes:n,parent:r}),r!==v.jstree.root?(this._node_changed(r),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==e&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)},_append_json_data:function(e,t,o,i){if(null!==this.element){(e=this.get_node(e)).children=[],e.children_d=[],t.d&&"string"==typeof(t=t.d)&&(t=JSON.parse(t)),v.vakata.is_array(t)||(t=[t]);var r=null,s={df:this._model.default_state,dat:t,par:e.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},j=this,n=function(e,c){var t=(e=e.data?e.data:e).dat,i=e.par,r=[],s=[],l=[],h=e.df,_=e.t_id,u=e.t_cnt,f=e.m,n=f[i],e=e.sel,a,d,o,g,p=function(e,t,i){i=i?i.concat():[],t&&i.unshift(t);var r=e.id.toString(),s,n,a,d,o={id:r,text:e.text||"",icon:e.icon===c||e.icon,parent:t,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in h)h.hasOwnProperty(s)&&(o.state[s]=h[s]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(o.icon=e.data.jstree.icon),o.icon!==c&&null!==o.icon&&""!==o.icon||(o.icon=!0),e&&e.data&&(o.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(o.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(o.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(o.li_attr[s]=e.li_attr[s]);if(o.li_attr.id||(o.li_attr.id=r),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(o.a_attr[s]=e.a_attr[s]);for(e&&e.children&&!0===e.children&&(o.state.loaded=!1,o.children=[],o.children_d=[]),s=0,n=(f[o.id]=o).children.length;s<n;s++)a=p(f[o.children[s]],o.id,i),d=f[a],o.children_d.push(a),d.children_d.length&&(o.children_d=o.children_d.concat(d.children_d));return delete e.data,delete e.children,f[o.id].original=e,o.state.selected&&l.push(o.id),o.id},m=function(e,t,i){i=i?i.concat():[],t&&i.unshift(t);var r=!1,s,n,a,d,o;do{r="j"+_+"_"+ ++u}while(f[r]);for(s in o={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===c||e.icon,parent:t,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},h)h.hasOwnProperty(s)&&(o.state[s]=h[s]);if(e&&(e.id||0===e.id)&&(o.id=e.id.toString()),e&&e.text&&(o.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(o.icon=e.data.jstree.icon),o.icon!==c&&null!==o.icon&&""!==o.icon||(o.icon=!0),e&&e.data&&(o.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(o.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(o.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(o.li_attr[s]=e.li_attr[s]);if(o.li_attr.id&&!o.id&&0!==o.id&&(o.id=o.li_attr.id.toString()),o.id||0===o.id||(o.id=r),o.li_attr.id||(o.li_attr.id=o.id),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(o.a_attr[s]=e.a_attr[s]);if(e&&e.children&&e.children.length){for(s=0,n=e.children.length;s<n;s++)a=m(e.children[s],o.id,i),d=f[a],o.children.push(a),d.children_d.length&&(o.children_d=o.children_d.concat(d.children_d));o.children_d=o.children_d.concat(o.children)}return e&&e.children&&!0===e.children&&(o.state.loaded=!1,o.children=[],o.children_d=[]),delete e.data,delete e.children,o.original=e,(f[o.id]=o).state.selected&&l.push(o.id),o.id};if(t.length&&t[0].id!==c&&t[0].parent!==c){for(d=0,o=t.length;d<o;d++)t[d].children||(t[d].children=[]),t[d].state||(t[d].state={}),f[t[d].id.toString()]=t[d];for(d=0,o=t.length;d<o;d++)f[t[d].parent.toString()]?(f[t[d].parent.toString()].children.push(t[d].id.toString()),n.children_d.push(t[d].id.toString())):void 0!==j&&(j._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:t[d].id.toString(),parent:t[d].parent.toString()})},j.settings.core.error.call(j,j._data.core.last_error));for(d=0,o=n.children.length;d<o;d++)a=p(f[n.children[d]],i,n.parents.concat()),s.push(a),f[a].children_d.length&&(s=s.concat(f[a].children_d));for(d=0,o=n.parents.length;d<o;d++)f[n.parents[d]].children_d=f[n.parents[d]].children_d.concat(s);g={cnt:u,mod:f,sel:e,par:i,dpc:s,add:l}}else{for(d=0,o=t.length;d<o;d++)(a=m(t[d],i,n.parents.concat()))&&(r.push(a),s.push(a),f[a].children_d.length&&(s=s.concat(f[a].children_d)));for(n.children=r,n.children_d=s,d=0,o=n.parents.length;d<o;d++)f[n.parents[d]].children_d=f[n.parents[d]].children_d.concat(s);g={cnt:u,mod:f,sel:e,par:i,dpc:s,add:l}}if("undefined"!=typeof window&&void 0!==window.document)return g;postMessage(g)},a=function(e,t){if(null!==this.element){var i,r;for(i in this._cnt=e.cnt,r=this._model.data)r.hasOwnProperty(i)&&r[i].state&&r[i].state.loading&&e.mod[i]&&(e.mod[i].state.loading=!0);if(this._model.data=e.mod,t){var s,n=e.add,a=e.sel,d=this._data.core.selected.slice(),r=this._model.data;if(a.length!==d.length||v.vakata.array_unique(a.concat(d)).length!==a.length){for(i=0,s=a.length;i<s;i++)-1===v.inArray(a[i],n)&&-1===v.inArray(a[i],d)&&(r[a[i]].state.selected=!1);for(i=0,s=d.length;i<s;i++)-1===v.inArray(d[i],a)&&(r[d[i]].state.selected=!0)}}e.add.length&&(this._data.core.selected=this._data.core.selected.concat(e.add)),this.trigger("model",{nodes:e.dpc,parent:e.par}),e.par!==v.jstree.root?(this._node_changed(e.par),this.redraw()):this.redraw(!0),e.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),!t&&c?c(function(){o.call(j,!0)}):o.call(j,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+n.toString()],{type:"text/javascript"}))),!this._data.core.working||i?(this._data.core.working=!0,(r=new window.Worker(this._wrk)).onmessage=function(e){a.call(this,e.data,!0);try{r.terminate(),r=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}.bind(this),r.onerror=function(e){a.call(this,n(s),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}.bind(this),s.par?r.postMessage(s):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([e,t,o,!0])}catch(e){a.call(this,n(s),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else a.call(this,n(s),!1)}},_parse_model_from_html:function(e,t,i){i=i?[].concat(i):[],t&&i.unshift(t);var r,s,n=this._model.data,a={id:!1,text:!1,icon:!0,parent:t,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},d,t,o;for(d in this._model.default_state)this._model.default_state.hasOwnProperty(d)&&(a.state[d]=this._model.default_state[d]);if(t=v.vakata.attributes(e,!0),v.each(t,function(e,t){return!(t=v.vakata.trim(t)).length||(a.li_attr[e]=t,void("id"===e&&(a.id=t.toString())))}),(t=e.children("a").first()).length&&(t=v.vakata.attributes(t,!0),v.each(t,function(e,t){(t=v.vakata.trim(t)).length&&(a.a_attr[e]=t)})),(t=(e.children("a").first().length?e.children("a").first():e).clone()).children("ins, i, ul").remove(),t=t.html(),t=v("<div></div>").html(t),a.text=this.settings.core.force_text?t.text():t.html(),t=e.data(),a.data=t?v.extend(!0,{},t):null,a.state.opened=e.hasClass("jstree-open"),a.state.selected=e.children("a").hasClass("jstree-clicked"),a.state.disabled=e.children("a").hasClass("jstree-disabled"),a.data&&a.data.jstree)for(d in a.data.jstree)a.data.jstree.hasOwnProperty(d)&&(a.state[d]=a.data.jstree[d]);(t=e.children("a").children(".jstree-themeicon")).length&&(a.icon=!t.hasClass("jstree-themeicon-hidden")&&t.attr("rel")),a.state.icon!==y&&(a.icon=a.state.icon),a.icon!==y&&null!==a.icon&&""!==a.icon||(a.icon=!0),t=e.children("ul").children("li");do{o="j"+this._id+"_"+ ++this._cnt}while(n[o]);return a.id=a.li_attr.id?a.li_attr.id.toString():o,t.length?(t.each(function(e,t){r=this._parse_model_from_html(v(t),a.id,i),s=this._model.data[r],a.children.push(r),s.children_d.length&&(a.children_d=a.children_d.concat(s.children_d))}.bind(this)),a.children_d=a.children_d.concat(a.children)):e.hasClass("jstree-closed")&&(a.state.loaded=!1),a.li_attr.class&&(a.li_attr.class=a.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),a.a_attr.class&&(a.a_attr.class=a.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),(n[a.id]=a).state.selected&&this._data.core.selected.push(a.id),a.id},_parse_model_from_flat_json:function(e,t,i){i=i?i.concat():[],t&&i.unshift(t);var r=e.id.toString(),s=this._model.data,n=this._model.default_state,a,d,o,c,l={id:r,text:e.text||"",icon:e.icon===y||e.icon,parent:t,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in n)n.hasOwnProperty(a)&&(l.state[a]=n[a]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==y&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(a in e.data.jstree)e.data.jstree.hasOwnProperty(a)&&(l.state[a]=e.data.jstree[a]);if(e&&"object"==typeof e.state)for(a in e.state)e.state.hasOwnProperty(a)&&(l.state[a]=e.state[a]);if(e&&"object"==typeof e.li_attr)for(a in e.li_attr)e.li_attr.hasOwnProperty(a)&&(l.li_attr[a]=e.li_attr[a]);if(l.li_attr.id||(l.li_attr.id=r),e&&"object"==typeof e.a_attr)for(a in e.a_attr)e.a_attr.hasOwnProperty(a)&&(l.a_attr[a]=e.a_attr[a]);for(e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),a=0,d=(s[l.id]=l).children.length;a<d;a++)c=s[o=this._parse_model_from_flat_json(s[l.children[a]],l.id,i)],l.children_d.push(o),c.children_d.length&&(l.children_d=l.children_d.concat(c.children_d));return delete e.data,delete e.children,s[l.id].original=e,l.state.selected&&this._data.core.selected.push(l.id),l.id},_parse_model_from_json:function(e,t,i){i=i?i.concat():[],t&&i.unshift(t);var r=!1,s,n,a,d,o=this._model.data,c=this._model.default_state,l;do{r="j"+this._id+"_"+ ++this._cnt}while(o[r]);for(s in l={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===y||e.icon,parent:t,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},c)c.hasOwnProperty(s)&&(l.state[s]=c[s]);if(e&&(e.id||0===e.id)&&(l.id=e.id.toString()),e&&e.text&&(l.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==y&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(l.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(l.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(l.li_attr[s]=e.li_attr[s]);if(l.li_attr.id&&!l.id&&0!==l.id&&(l.id=l.li_attr.id.toString()),l.id||0===l.id||(l.id=r),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(l.a_attr[s]=e.a_attr[s]);if(e&&e.children&&e.children.length){for(s=0,n=e.children.length;s<n;s++)d=o[a=this._parse_model_from_json(e.children[s],l.id,i)],l.children.push(a),d.children_d.length&&(l.children_d=l.children_d.concat(d.children_d));l.children_d=l.children.concat(l.children_d)}return e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,(o[l.id]=l).state.selected&&this._data.core.selected.push(l.id),l.id},_redraw:function(){for(var e=(this._model.force_full_redraw?this._model.data[v.jstree.root].children:this._model.changed).concat([]),t=x.createElement("UL"),i,r,s,n=this._data.core.focused,r=0,s=e.length;r<s;r++)(i=this.redraw_node(e[r],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&t.appendChild(i);this._model.force_full_redraw&&(t.className=this.get_container_ul()[0].className,t.setAttribute("role","presentation"),this.element.empty().append(t)),null!==n&&this.settings.core.restore_focus&&((i=this.get_node(n,!0))&&i.length&&i.children(".jstree-anchor")[0]!==x.activeElement?i.children(".jstree-anchor").trigger("focus"):this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:e})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(e){var t=this.get_node(e),i=!1,r=!1,s=!1,n=x;if(!t)return!1;if(t.id===v.jstree.root)return this.redraw(!0);if(!(e=this.get_node(e,!0))||!e.length)return!1;if(e.children(".jstree-children").remove(),e=e[0],t.children.length&&t.state.loaded){for((s=n.createElement("UL")).setAttribute("role","group"),s.className="jstree-children",i=0,r=t.children.length;i<r;i++)s.appendChild(this.redraw_node(t.children[i],!0,!0));e.appendChild(s)}},redraw_node:function(e,t,i,r){var s=this.get_node(e),n=!1,a=!1,d=!1,o=!1,c=!1,l=!1,h="",_=x,u=this._model.data,f=!1,g=!1,p=null,m=0,j=0,k=!1,b=!1;if(!s)return!1;if(s.id===v.jstree.root)return this.redraw(!0);if(t=t||0===s.children.length,e=x.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(s.id[0])?"\\3"+s.id[0]+" "+s.id.substr(1).replace(v.jstree.idregex,"\\$&"):s.id.replace(v.jstree.idregex,"\\$&"))):x.getElementById(s.id))e=v(e),i||((n=e.parent().parent()[0])===this.element[0]&&(n=null),a=e.index()),(t=!t&&s.children.length&&!e.children(".jstree-children").length?!0:t)||(d=e.children(".jstree-children")[0]),f=e.children(".jstree-anchor")[0]===x.activeElement,e.remove();else if(t=!0,!i){if(!(null===(n=s.parent!==v.jstree.root?v("#"+s.parent.replace(v.jstree.idregex,"\\$&"),this.element)[0]:null)||n&&u[s.parent].state.opened))return!1;a=v.inArray(s.id,(null===n?u[v.jstree.root]:u[s.parent]).children)}for(o in e=this._data.core.node.cloneNode(!0),h="jstree-node ",s.li_attr)s.li_attr.hasOwnProperty(o)&&"id"!==o&&("class"!==o?e.setAttribute(o,s.li_attr[o]):h+=s.li_attr[o]);for(s.a_attr.id||(s.a_attr.id=s.id+"_anchor"),e.childNodes[1].setAttribute("aria-selected",!!s.state.selected),e.childNodes[1].setAttribute("aria-level",s.parents.length),this.settings.core.compute_elements_positions&&(e.childNodes[1].setAttribute("aria-setsize",u[s.parent].children.length),e.childNodes[1].setAttribute("aria-posinset",u[s.parent].children.indexOf(s.id)+1)),s.state.disabled&&e.childNodes[1].setAttribute("aria-disabled",!0),o=0,c=s.children.length;o<c;o++)if(!u[s.children[o]].state.hidden){k=!0;break}if(null!==s.parent&&u[s.parent]&&!s.state.hidden&&(o=v.inArray(s.id,u[s.parent].children),b=s.id,-1!==o))for(o++,c=u[s.parent].children.length;o<c;o++)if((b=!u[u[s.parent].children[o]].state.hidden?u[s.parent].children[o]:b)!==s.id)break;for(c in s.state.hidden&&(h+=" jstree-hidden"),s.state.loading&&(h+=" jstree-loading"),s.state.loaded&&!k?h+=" jstree-leaf":(h+=s.state.opened&&s.state.loaded?" jstree-open":" jstree-closed",e.childNodes[1].setAttribute("aria-expanded",s.state.opened&&s.state.loaded)),b===s.id&&(h+=" jstree-last"),e.id=s.id,e.className=h,h=(s.state.selected?" jstree-clicked":"")+(s.state.disabled?" jstree-disabled":""),s.a_attr)s.a_attr.hasOwnProperty(c)&&("href"===c&&"#"===s.a_attr[c]||("class"!==c?e.childNodes[1].setAttribute(c,s.a_attr[c]):h+=" "+s.a_attr[c]));if(h.length&&(e.childNodes[1].className="jstree-anchor "+h),(s.icon&&!0!==s.icon||!1===s.icon)&&(!1===s.icon?e.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===s.icon.indexOf("/")&&-1===s.icon.indexOf(".")?e.childNodes[1].childNodes[0].className+=" "+s.icon+" jstree-themeicon-custom":(e.childNodes[1].childNodes[0].style.backgroundImage='url("'+s.icon+'")',e.childNodes[1].childNodes[0].style.backgroundPosition="center center",e.childNodes[1].childNodes[0].style.backgroundSize="auto",e.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?e.childNodes[1].appendChild(_.createTextNode(s.text)):e.childNodes[1].innerHTML+=s.text,t&&s.children.length&&(s.state.opened||r)&&s.state.loaded){for((l=_.createElement("UL")).setAttribute("role","group"),l.className="jstree-children",o=0,c=s.children.length;o<c;o++)l.appendChild(this.redraw_node(s.children[o],t,!0));e.appendChild(l)}if(d&&e.appendChild(d),!i){for(o=0,c=(n=n||this.element[0]).childNodes.length;o<c;o++)if(n.childNodes[o]&&n.childNodes[o].className&&-1!==n.childNodes[o].className.indexOf("jstree-children")){p=n.childNodes[o];break}p||((p=_.createElement("UL")).setAttribute("role","group"),p.className="jstree-children",n.appendChild(p)),a<(n=p).childNodes.length?n.insertBefore(e,n.childNodes[a]):n.appendChild(e),f&&(m=this.element[0].scrollTop,j=this.element[0].scrollLeft,e.childNodes[1].focus(),this.element[0].scrollTop=m,this.element[0].scrollLeft=j)}return s.state.opened&&!s.state.loaded&&(s.state.opened=!1,setTimeout(function(){this.open_node(s.id,!1,0)}.bind(this),0)),e},open_node:function(e,i,r){var t,s,n,a;if(v.vakata.is_array(e)){for(t=0,s=(e=e.slice()).length;t<s;t++)this.open_node(e[t],i,r);return!0}return!(!(e=this.get_node(e))||e.id===v.jstree.root)&&(r=r===y?this.settings.core.animation:r,this.is_closed(e)?this.is_loaded(e)?(n=this.get_node(e,!0),a=this,n.length&&(r&&n.children(".jstree-children").length&&n.children(".jstree-children").stop(!0,!0),e.children.length&&!this._firstChild(n.children(".jstree-children")[0])&&this.draw_children(e),r?(this.trigger("before_open",{node:e}),n.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").children(".jstree-anchor").attr("aria-expanded",!0).end().children(".jstree-children").stop(!0,!0).slideDown(r,function(){this.style.display="",a.element&&a.trigger("after_open",{node:e})})):(this.trigger("before_open",{node:e}),n[0].className=n[0].className.replace("jstree-closed","jstree-open"),n[0].childNodes[1].setAttribute("aria-expanded",!0))),e.state.opened=!0,i&&i.call(this,e,!0),n.length||this.trigger("before_open",{node:e}),this.trigger("open_node",{node:e}),r&&n.length||this.trigger("after_open",{node:e}),!0):this.is_loading(e)?setTimeout(function(){this.open_node(e,i,r)}.bind(this),500):void this.load_node(e,function(e,t){return t?this.open_node(e,i,r):!!i&&i.call(this,e,!1)}):(i&&i.call(this,e,!1),!1))},_open_to:function(e){if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;for(var t,i,r=e.parents,t=0,i=r.length;t<i;t+=1)t!==v.jstree.root&&this.open_node(r[t],!1,0);return v("#"+e.id.replace(v.jstree.idregex,"\\$&"),this.element)},close_node:function(e,t){var i,r,s,n;if(v.vakata.is_array(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.close_node(e[i],t);return!0}return!(!(e=this.get_node(e))||e.id===v.jstree.root)&&(!this.is_closed(e)&&(t=t===y?this.settings.core.animation:t,n=(s=this).get_node(e,!0),e.state.opened=!1,this.trigger("close_node",{node:e}),void(n.length?t?n.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").children(".jstree-anchor").attr("aria-expanded",!1).end().children(".jstree-children").stop(!0,!0).slideUp(t,function(){this.style.display="",n.children(".jstree-children").remove(),s.element&&s.trigger("after_close",{node:e})}):(n[0].className=n[0].className.replace("jstree-open","jstree-closed"),n.children(".jstree-anchor").attr("aria-expanded",!1),n.children(".jstree-children").remove(),this.trigger("after_close",{node:e})):this.trigger("after_close",{node:e}))))},toggle_node:function(e){var t,i;if(v.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.toggle_node(e[t]);return!0}return this.is_closed(e)?this.open_node(e):this.is_open(e)?this.close_node(e):void 0},open_all:function(e,i,r){if(e=e||v.jstree.root,!(e=this.get_node(e)))return!1;var t=e.id===v.jstree.root?this.get_container_ul():this.get_node(e,!0),s,n,a;if(!t.length){for(s=0,n=e.children_d.length;s<n;s++)this.is_closed(this._model.data[e.children_d[s]])&&(this._model.data[e.children_d[s]].state.opened=!0);return this.trigger("open_all",{node:e})}r=r||t,(t=(a=this).is_closed(e)?t.find(".jstree-closed").addBack():t.find(".jstree-closed")).each(function(){a.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,i,r)},i||0)}),0===r.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(r)})},close_all:function(e,t){if(e=e||v.jstree.root,!(e=this.get_node(e)))return!1;var i=e.id===v.jstree.root?this.get_container_ul():this.get_node(e,!0),r=this,s,n;for(i.length&&(i=this.is_open(e)?i.find(".jstree-open").addBack():i.find(".jstree-open"),v(i.get().reverse()).each(function(){r.close_node(this,t||0)})),s=0,n=e.children_d.length;s<n;s++)this._model.data[e.children_d[s]].state.opened=!1;this.trigger("close_all",{node:e})},is_disabled:function(e){return(e=this.get_node(e))&&e.state&&e.state.disabled},enable_node:function(e){var t,i;if(v.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.enable_node(e[t]);return!0}if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;e.state.disabled=!1,this.get_node(e,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),this.trigger("enable_node",{node:e})},disable_node:function(e){var t,i;if(v.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.disable_node(e[t]);return!0}if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;e.state.disabled=!0,this.get_node(e,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),this.trigger("disable_node",{node:e})},is_hidden:function(e){return!0===(e=this.get_node(e)).state.hidden},hide_node:function(e,t){var i,r;if(v.vakata.is_array(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.hide_node(e[i],!0);return t||this.redraw(),!0}if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;e.state.hidden||(e.state.hidden=!0,this._node_changed(e.parent),t||this.redraw(),this.trigger("hide_node",{node:e}))},show_node:function(e,t){var i,r;if(v.vakata.is_array(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.show_node(e[i],!0);return t||this.redraw(),!0}if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;e.state.hidden&&(e.state.hidden=!1,this._node_changed(e.parent),t||this.redraw(),this.trigger("show_node",{node:e}))},hide_all:function(e){var t,i=this._model.data,r=[];for(t in i)i.hasOwnProperty(t)&&t!==v.jstree.root&&!i[t].state.hidden&&(i[t].state.hidden=!0,r.push(t));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("hide_all",{nodes:r}),r},show_all:function(e){var t,i=this._model.data,r=[];for(t in i)i.hasOwnProperty(t)&&t!==v.jstree.root&&i[t].state.hidden&&(i[t].state.hidden=!1,r.push(t));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("show_all",{nodes:r}),r},activate_node:function(e,t){if(this.is_disabled(e))return!1;if(t&&"object"==typeof t||(t={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==y?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&(!t.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(t.shiftKey){for(var i=this.get_node(e).id,r=this._data.core.last_clicked.id,s=this.get_node(this._data.core.last_clicked.parent).children,n=!1,a,d,a=0,d=s.length;a<d;a+=1)s[a]===i&&(n=!n),s[a]===r&&(n=!n),this.is_disabled(s[a])||!n&&s[a]!==i&&s[a]!==r?t.ctrlKey||this.deselect_node(s[a],!0,t):this.is_hidden(s[a])||this.select_node(s[a],!0,!1,t);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:t})}else this.is_selected(e)?this.deselect_node(e,!1,t):(t.ctrlKey&&(this._data.core.last_clicked=this.get_node(e)),this.select_node(e,!1,!1,t));else!this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,t):(!this.settings.core.allow_reselect&&this.is_selected(e)&&1===this._data.core.selected.length||(this.deselect_all(!0),this.select_node(e,!1,!1,t)),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:t})},hover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),i=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){i.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||!e.children(".jstree-hovered").length)return!1;e.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(e)})},select_node:function(e,t,i,r){var s,n,a,d;if(v.vakata.is_array(e)){for(n=0,a=(e=e.slice()).length;n<a;n++)this.select_node(e[n],t,i,r);return!0}if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;s=this.get_node(e,!0),e.state.selected||(e.state.selected=!0,this._data.core.selected.push(e.id),(s=!i?this._open_to(e):s)&&s.length&&s.children(".jstree-anchor").addClass("jstree-clicked").attr("aria-selected",!0),this.trigger("select_node",{node:e,selected:this._data.core.selected,event:r}),t||this.trigger("changed",{action:"select_node",node:e,selected:this._data.core.selected,event:r}))},deselect_node:function(e,t,i){var r,s,n;if(v.vakata.is_array(e)){for(r=0,s=(e=e.slice()).length;r<s;r++)this.deselect_node(e[r],t,i);return!0}if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;n=this.get_node(e,!0),e.state.selected&&(e.state.selected=!1,this._data.core.selected=v.vakata.array_remove_item(this._data.core.selected,e.id),n.length&&n.children(".jstree-anchor").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_node",{node:e,selected:this._data.core.selected,event:i}),t||this.trigger("changed",{action:"deselect_node",node:e,selected:this._data.core.selected,event:i}))},select_all:function(e){var t=this._data.core.selected.concat([]),i,r;for(this._data.core.selected=this._model.data[v.jstree.root].children_d.concat(),i=0,r=this._data.core.selected.length;i<r;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),e||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:t})},deselect_all:function(e){for(var t=this._data.core.selected.concat([]),i,r,i=0,r=this._data.core.selected.length;i<r;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:t}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:t})},is_selected:function(e){return!(!(e=this.get_node(e))||e.id===v.jstree.root)&&e.state.selected},get_selected:function(e){return e?v.map(this._data.core.selected,function(e){return this.get_node(e)}.bind(this)):this._data.core.selected.slice()},get_top_selected:function(e){for(var t=this.get_selected(!0),i={},r,s,n,a,r=0,s=t.length;r<s;r++)i[t[r].id]=t[r];for(r=0,s=t.length;r<s;r++)for(n=0,a=t[r].children_d.length;n<a;n++)i[t[r].children_d[n]]&&delete i[t[r].children_d[n]];for(r in t=[],i)i.hasOwnProperty(r)&&t.push(r);return e?v.map(t,function(e){return this.get_node(e)}.bind(this)):t},get_bottom_selected:function(e){for(var t=this.get_selected(!0),i=[],r,s,r=0,s=t.length;r<s;r++)t[r].children.length||i.push(t[r].id);return e?v.map(i,function(e){return this.get_node(e)}.bind(this)):i},get_state:function(){var e={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}},t;for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==v.jstree.root&&(this._model.data[t].state.loaded&&this.settings.core.loaded_state&&e.core.loaded.push(t),this._model.data[t].state.opened&&e.core.open.push(t),this._model.data[t].state.selected&&e.core.selected.push(t));return e},set_state:function(t,i){if(t){if(t.core&&t.core.selected&&t.core.initial_selection===y&&(t.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),t.core){var e,r,s,n,a;if(t.core.loaded)return this.settings.core.loaded_state&&v.vakata.is_array(t.core.loaded)&&t.core.loaded.length?this._load_nodes(t.core.loaded,function(e){delete t.core.loaded,this.set_state(t,i)}):(delete t.core.loaded,this.set_state(t,i)),!1;if(t.core.open)return v.vakata.is_array(t.core.open)&&t.core.open.length?this._load_nodes(t.core.open,function(e){this.open_node(e,!1,0),delete t.core.open,this.set_state(t,i)}):(delete t.core.open,this.set_state(t,i)),!1;if(t.core.scroll)return t.core.scroll&&t.core.scroll.left!==y&&this.element.scrollLeft(t.core.scroll.left),t.core.scroll&&t.core.scroll.top!==y&&this.element.scrollTop(t.core.scroll.top),delete t.core.scroll,this.set_state(t,i),!1;if(t.core.selected)return n=this,t.core.initial_selection!==y&&t.core.initial_selection!==this._data.core.selected.concat([]).sort().join(",")||(this.deselect_all(),v.each(t.core.selected,function(e,t){n.select_node(t,!1,!0)})),delete t.core.initial_selection,delete t.core.selected,this.set_state(t,i),!1;for(a in t)t.hasOwnProperty(a)&&"core"!==a&&-1===v.inArray(a,this.settings.plugins)&&delete t[a];if(v.isEmptyObject(t.core))return delete t.core,this.set_state(t,i),!1}return v.isEmptyObject(t)?(t=null,i&&i.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(e,t){this._data.core.state=!0===t?{}:this.get_state(),t&&v.vakata.is_function(t)&&(this._data.core.state=t.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[v.jstree.root]={id:v.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var i=this.get_container_ul()[0].className;e||(this.element.html("<ul class='"+i+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(v.jstree.root,function(e,t){t&&(this.get_container_ul()[0].className=i,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(v.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(!(t=this.get_node(t))||t.id===v.jstree.root)return!1;var i=[],e=[],r=this._data.core.selected.concat([]);e.push(t.id),!0===t.state.opened&&i.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){e.push(this.id),i.push(this.id)}),this._load_nodes(e,function(e){this.open_node(i,!1,0),this.select_node(r),this.trigger("refresh_node",{node:t,nodes:e})}.bind(this),!1,!0)},set_id:function(e,t){if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;var i,r,s=this._model.data,n=e.id;for(t=t.toString(),s[e.parent].children[v.inArray(e.id,s[e.parent].children)]=t,i=0,r=e.parents.length;i<r;i++)s[e.parents[i]].children_d[v.inArray(e.id,s[e.parents[i]].children_d)]=t;for(i=0,r=e.children.length;i<r;i++)s[e.children[i]].parent=t;for(i=0,r=e.children_d.length;i<r;i++)s[e.children_d[i]].parents[v.inArray(e.id,s[e.children_d[i]].parents)]=t;return-1!==(i=v.inArray(e.id,this._data.core.selected))&&(this._data.core.selected[i]=t),(i=this.get_node(e.id,!0))&&(i.attr("id",t),this.element.attr("aria-activedescendant")===e.id&&this.element.attr("aria-activedescendant",t)),delete s[e.id],e.id=t,s[e.li_attr.id=t]=e,this.trigger("set_id",{node:e,new:e.id,old:n}),!0},get_text:function(e){return!(!(e=this.get_node(e))||e.id===v.jstree.root)&&e.text},set_text:function(e,t){var i,r;if(v.vakata.is_array(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.set_text(e[i],t);return!0}return!(!(e=this.get_node(e))||e.id===v.jstree.root)&&(e.text=t,this.get_node(e,!0).length&&this.redraw_node(e.id),this.trigger("set_text",{obj:e,text:t}),!0)},get_json:function(e,t,i){if(!(e=this.get_node(e||v.jstree.root)))return!1;t&&t.flat&&!i&&(i=[]);var r={id:e.id,text:e.text,icon:this.get_icon(e),li_attr:v.extend(!0,{},e.li_attr),a_attr:v.extend(!0,{},e.a_attr),state:{},data:(!t||!t.no_data)&&v.extend(!0,v.vakata.is_array(e.data)?[]:{},e.data)},s,n;if(t&&t.flat?r.parent=e.parent:r.children=[],t&&t.no_state)delete r.state;else for(s in e.state)e.state.hasOwnProperty(s)&&(r.state[s]=e.state[s]);if(t&&t.no_li_attr&&delete r.li_attr,t&&t.no_a_attr&&delete r.a_attr,t&&t.no_id&&(delete r.id,r.li_attr&&r.li_attr.id&&delete r.li_attr.id,r.a_attr&&r.a_attr.id&&delete r.a_attr.id),t&&t.flat&&e.id!==v.jstree.root&&i.push(r),!t||!t.no_children)for(s=0,n=e.children.length;s<n;s++)t&&t.flat?this.get_json(e.children[s],t,i):r.children.push(this.get_json(e.children[s],t));return t&&t.flat?i:e.id===v.jstree.root?r.children:r},create_node:function(e,t,i,r,s){if(null===e&&(e=v.jstree.root),!(e=this.get_node(e)))return!1;if(!(i=i===y?"last":i).toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(e))return this.load_node(e,function(){this.create_node(e,t,i,r,!0)});var n,a,d,o;switch((t="string"==typeof(t=t||{text:this.get_string("New node")})?{text:t}:v.extend(!0,{},t)).text===y&&(t.text=this.get_string("New node")),i=e.id===v.jstree.root&&"after"===(i="before"===i?"first":i)?"last":i){case"before":n=this.get_node(e.parent),i=v.inArray(e.id,n.children),e=n;break;case"after":n=this.get_node(e.parent),i=v.inArray(e.id,n.children)+1,e=n;break;case"inside":case"first":i=0;break;case"last":i=e.children.length;break;default:i=i||0}if(i>e.children.length&&(i=e.children.length),t.id===y&&(t.id=!0),!this.check("create_node",t,e,i))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===t.id&&delete t.id,!(t=this._parse_model_from_json(t,e.id,e.parents.concat())))return!1;for(n=this.get_node(t),(a=[]).push(t),a=a.concat(n.children_d),this.trigger("model",{nodes:a,parent:e.id}),e.children_d=e.children_d.concat(a),d=0,o=e.parents.length;d<o;d++)this._model.data[e.parents[d]].children_d=this._model.data[e.parents[d]].children_d.concat(a);for(t=n,n=[],d=0,o=e.children.length;d<o;d++)n[i<=d?d+1:d]=e.children[d];return n[i]=t.id,e.children=n,this.redraw_node(e,!0),this.trigger("create_node",{node:this.get_node(t),parent:e.id,position:i}),r&&r.call(this,this.get_node(t)),t.id},rename_node:function(e,t){var i,r,s;if(v.vakata.is_array(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.rename_node(e[i],t);return!0}return!(!(e=this.get_node(e))||e.id===v.jstree.root)&&(s=e.text,this.check("rename_node",e,this.get_parent(e),t)?(this.set_text(e,t),this.trigger("rename_node",{node:e,text:t,old:s}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(e){var t,i,r,s,n,a,d,o,c,l,h,s;if(v.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.delete_node(e[t]);return!0}if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;if(r=this.get_node(e.parent),s=v.inArray(e.id,r.children),l=!1,!this.check("delete_node",e,r,s))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==s&&(r.children=v.vakata.array_remove(r.children,s)),(n=e.children_d.concat([])).push(e.id),a=0,d=e.parents.length;a<d;a++)this._model.data[e.parents[a]].children_d=v.vakata.array_filter(this._model.data[e.parents[a]].children_d,function(e){return-1===v.inArray(e,n)});for(o=0,c=n.length;o<c;o++)if(this._model.data[n[o]].state.selected){l=!0;break}for(l&&(this._data.core.selected=v.vakata.array_filter(this._data.core.selected,function(e){return-1===v.inArray(e,n)})),this.trigger("delete_node",{node:e,parent:r.id}),l&&this.trigger("changed",{action:"delete_node",node:e,selected:this._data.core.selected,parent:r.id}),o=0,c=n.length;o<c;o++)delete this._model.data[n[o]];return-1!==v.inArray(this._data.core.focused,n)&&(this._data.core.focused=null,h=this.element[0].scrollTop,s=this.element[0].scrollLeft,r.id===v.jstree.root?this._model.data[v.jstree.root].children[0]&&this.get_node(this._model.data[v.jstree.root].children[0],!0).children(".jstree-anchor").trigger("focus"):this.get_node(r,!0).children(".jstree-anchor").trigger("focus"),this.element[0].scrollTop=h,this.element[0].scrollLeft=s),this.redraw_node(r,!0),!0},check:function(e,t,i,r,s){t=t&&t.id?t:this.get_node(t),i=i&&i.id?i:this.get_node(i);var n=e.match(/^(move_node|copy_node|create_node)$/i)?i:t,a=this.settings.core.check_callback;if("move_node"===e||"copy_node"===e){if(!(s&&s.is_multi||"move_node"!==e||v.inArray(t.id,i.children)!==r))return!(this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})});if(!(s&&s.is_multi||t.id!==i.id&&("move_node"!==e||v.inArray(t.id,i.children)!==r)&&-1===v.inArray(i.id,t.children_d)))return!(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})})}return(n=n&&n.data?n.data:n)&&n.functions&&(!1===n.functions[e]||!0===n.functions[e])?(!1===n.functions[e]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})}),n.functions[e]):!(!1===a||v.vakata.is_function(a)&&!1===a.call(this,e,t,i,r,s)||a&&!1===a[e])||!(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id)&&t.id,par:!(!i||!i.id)&&i.id})})},last_error:function(){return this._data.core.last_error},move_node:function(e,t,i,r,s,n,a){var d,o,c,l,h,_,u,f,g,p,m,j,k,b;if(t=this.get_node(t),i=i===y?0:i,!t)return!1;if(!i.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(t))return this.load_node(t,function(){this.move_node(e,t,i,r,!0,!1,a)});if(v.vakata.is_array(e)){if(1!==e.length){for(d=0,o=e.length;d<o;d++)(g=this.move_node(e[d],t,i,r,s,!1,a))&&(t=g,i="after");return this.redraw(),!0}e=e[0]}if(!(e=e&&e.id!==y?e:this.get_node(e))||e.id===v.jstree.root)return!1;if(c=(e.parent||v.jstree.root).toString(),h=i.toString().match(/^(before|after)$/)&&t.id!==v.jstree.root?this.get_node(t.parent):t,u=!(_=a||(this._model.data[e.id]?this:v.jstree.reference(e.id)))||!_._id||this._id!==_._id,l=_&&_._id&&c&&_._model.data[c]&&_._model.data[c].children?v.inArray(e.id,_._model.data[c].children):-1,_&&_._id&&(e=_._model.data[e.id]),u)return!!(g=this.copy_node(e,t,i,r,s,!1,a))&&(_&&_.delete_node(e),g);switch(i=t.id===v.jstree.root&&"after"===(i="before"===i?"first":i)?"last":i){case"before":i=v.inArray(t.id,h.children);break;case"after":i=v.inArray(t.id,h.children)+1;break;case"inside":case"first":i=0;break;case"last":i=h.children.length;break;default:i=i||0}if(i>h.children.length&&(i=h.children.length),!this.check("move_node",e,h,i,{core:!0,origin:a,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(e.parent===h.id){for(f=h.children.concat(),-1!==(g=v.inArray(e.id,f))&&(f=v.vakata.array_remove(f,g),g<i&&i--),g=[],p=0,m=f.length;p<m;p++)g[i<=p?p+1:p]=f[p];g[i]=e.id,h.children=g,this._node_changed(h.id),this.redraw(h.id===v.jstree.root)}else{for((g=e.children_d.concat()).push(e.id),p=0,m=e.parents.length;p<m;p++){for(f=[],j=0,k=(b=_._model.data[e.parents[p]].children_d).length;j<k;j++)-1===v.inArray(b[j],g)&&f.push(b[j]);_._model.data[e.parents[p]].children_d=f}for(_._model.data[c].children=v.vakata.array_remove_item(_._model.data[c].children,e.id),p=0,m=h.parents.length;p<m;p++)this._model.data[h.parents[p]].children_d=this._model.data[h.parents[p]].children_d.concat(g);for(f=[],p=0,m=h.children.length;p<m;p++)f[i<=p?p+1:p]=h.children[p];for(f[i]=e.id,h.children=f,h.children_d.push(e.id),h.children_d=h.children_d.concat(e.children_d),e.parent=h.id,(g=h.parents.concat()).unshift(h.id),b=e.parents.length,g=(e.parents=g).concat(),p=0,m=e.children_d.length;p<m;p++)this._model.data[e.children_d[p]].parents=this._model.data[e.children_d[p]].parents.slice(0,-1*b),Array.prototype.push.apply(this._model.data[e.children_d[p]].parents,g);c!==v.jstree.root&&h.id!==v.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(c),this._node_changed(h.id)),n||this.redraw()}return r&&r.call(this,e,h,i),this.trigger("move_node",{node:e,parent:h.id,position:i,old_parent:c,old_position:l,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id,old_instance:_,new_instance:this}),e.id},copy_node:function(e,t,i,r,s,n,a){var d,o,c,l,h,_,u,f,g,p,m;if(t=this.get_node(t),i=i===y?0:i,!t)return!1;if(!i.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(t))return this.load_node(t,function(){this.copy_node(e,t,i,r,!0,!1,a)});if(v.vakata.is_array(e)){if(1!==e.length){for(d=0,o=e.length;d<o;d++)(l=this.copy_node(e[d],t,i,r,s,!0,a))&&(t=l,i="after");return this.redraw(),!0}e=e[0]}if(!(e=e&&e.id!==y?e:this.get_node(e))||e.id===v.jstree.root)return!1;switch(f=(e.parent||v.jstree.root).toString(),g=i.toString().match(/^(before|after)$/)&&t.id!==v.jstree.root?this.get_node(t.parent):t,m=!(p=a||(this._model.data[e.id]?this:v.jstree.reference(e.id)))||!p._id||this._id!==p._id,p&&p._id&&(e=p._model.data[e.id]),i=t.id===v.jstree.root&&"after"===(i="before"===i?"first":i)?"last":i){case"before":i=v.inArray(t.id,g.children);break;case"after":i=v.inArray(t.id,g.children)+1;break;case"inside":case"first":i=0;break;case"last":i=g.children.length;break;default:i=i||0}if(i>g.children.length&&(i=g.children.length),!this.check("copy_node",e,g,i,{core:!0,origin:a,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(u=p?p.get_json(e,{no_id:!0,no_data:!0,no_state:!0}):e))return!1;if(!0===u.id&&delete u.id,!(u=this._parse_model_from_json(u,g.id,g.parents.concat())))return!1;for(l=this.get_node(u),e&&e.state&&!1===e.state.loaded&&(l.state.loaded=!1),(c=[]).push(u),c=c.concat(l.children_d),this.trigger("model",{nodes:c,parent:g.id}),h=0,_=g.parents.length;h<_;h++)this._model.data[g.parents[h]].children_d=this._model.data[g.parents[h]].children_d.concat(c);for(c=[],h=0,_=g.children.length;h<_;h++)c[i<=h?h+1:h]=g.children[h];return c[i]=l.id,g.children=c,g.children_d.push(l.id),g.children_d=g.children_d.concat(l.children_d),g.id===v.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(g.id),n||this.redraw(g.id===v.jstree.root),r&&r.call(this,l,g,i),this.trigger("copy_node",{node:l,original:e,parent:g.id,position:i,old_parent:f,old_position:p&&p._id&&f&&p._model.data[f]&&p._model.data[f].children?v.inArray(e.id,p._model.data[f].children):-1,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id,old_instance:p,new_instance:this}),l.id},cut:function(e){if(e=e||this._data.core.selected.concat(),!(e=!v.vakata.is_array(e)?[e]:e).length)return!1;for(var t=[],i,r,s,r=0,s=e.length;r<s;r++)(i=this.get_node(e[r]))&&(i.id||0===i.id)&&i.id!==v.jstree.root&&t.push(i);if(!t.length)return!1;n=t,a="move_node",(d=this).trigger("cut",{node:e})},copy:function(e){if(e=e||this._data.core.selected.concat(),!(e=!v.vakata.is_array(e)?[e]:e).length)return!1;for(var t=[],i,r,s,r=0,s=e.length;r<s;r++)(i=this.get_node(e[r]))&&i.id!==y&&i.id!==v.jstree.root&&t.push(i);if(!t.length)return!1;n=t,a="copy_node",(d=this).trigger("copy",{node:e})},get_buffer:function(){return{mode:a,node:n,inst:d}},can_paste:function(){return!1!==a&&!1!==n},paste:function(e,t){if(!((e=this.get_node(e))&&a&&a.match(/^(copy_node|move_node)$/)&&n))return!1;this[a](n,e,t,!1,!1,!1,d)&&this.trigger("paste",{parent:e.id,node:n,mode:a}),d=a=n=!1},clear_buffer:function(){d=a=n=!1,this.trigger("clear_buffer")},edit:function(r,e,s){var t,i,n,a,d,o,c,t,l,h=!1;return!!(r=this.get_node(r))&&(this.check("edit",r,this.get_parent(r))?(l=r,e="string"==typeof e?e:r.text,this.set_text(r,""),r=this._open_to(r),l.text=e,t=this._data.core.rtl,i=this.element.width(),this._data.core.focused=l.id,n=r.children(".jstree-anchor").trigger("focus"),a=v("<span></span>"),d=e,o=v("<div></div>",{css:{position:"absolute",top:"-200px",left:t?"0px":"-1000px",visibility:"hidden"}}).appendTo(x.body),c=v("<input />",{value:d,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},on:{blur:function(e){e.stopImmediatePropagation(),e.preventDefault();var t,i=a.children(".jstree-rename-input").val(),e=this.settings.core.force_text,e;""===i&&(i=d),o.remove(),a.replaceWith(n),a.remove(),d=e?d:v("<div></div>").append(v.parseHTML(d)).html(),r=this.get_node(r),this.set_text(r,d),(e=!!this.rename_node(r,e?v("<div></div>").text(i).text():v("<div></div>").append(v.parseHTML(i)).html()))||this.set_text(r,d),this._data.core.focused=l.id,setTimeout(function(){var e=this.get_node(l.id,!0);e.length&&(this._data.core.focused=l.id,e.children(".jstree-anchor").trigger("focus"))}.bind(this),0),s&&s.call(this,l,e,h,i),c=null}.bind(this),keydown:function(e){var t=e.which;27===t&&(h=!0,this.value=d),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){c.width(Math.min(o.text("pW"+this.value).width(),i))},keypress:function(e){if(13===e.which)return!1}}}),t={fontFamily:n.css("fontFamily")||"",fontSize:n.css("fontSize")||"",fontWeight:n.css("fontWeight")||"",fontStyle:n.css("fontStyle")||"",fontStretch:n.css("fontStretch")||"",fontVariant:n.css("fontVariant")||"",letterSpacing:n.css("letterSpacing")||"",wordSpacing:n.css("wordSpacing")||""},a.attr("class",n.attr("class")).append(n.contents().clone()).append(c),n.replaceWith(a),o.css(t),c.css(t).width(Math.min(o.text("pW"+c[0].value).width(),i))[0].select(),void v(x).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(e){c&&e.target!==c&&v(c).trigger("blur")})):(this.settings.core.error.call(this,this._data.core.last_error),!1))},set_theme:function(e,t){if(!e)return!1;var i,i;(t=!0===t?(i=(i=this.settings.core.themes.dir)||v.jstree.path+"/themes")+"/"+e+"/style.css":t)&&-1===v.inArray(t,r)&&(v("head").append('<link rel="stylesheet" href="'+t+'" type="text/css" />'),r.push(t)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=e,this.element.addClass("jstree-"+e),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+e+"-responsive"),this.trigger("set_theme",{theme:e})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),(this._data.core.themes.variant=e)&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(e,t){var i,r,s,n;if(v.vakata.is_array(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.set_icon(e[i],t);return!0}return!(!(e=this.get_node(e))||e.id===v.jstree.root)&&(n=e.icon,e.icon=!0===t||null===t||t===y||""===t||t,s=this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===t?(s.removeClass("jstree-themeicon-custom "+n).css("background","").removeAttr("rel"),this.hide_icon(e)):(!0===t||null===t||t===y||""===t?s.removeClass("jstree-themeicon-custom "+n).css("background","").removeAttr("rel"):-1===t.indexOf("/")&&-1===t.indexOf(".")?(s.removeClass(n).css("background",""),s.addClass(t+" jstree-themeicon-custom").attr("rel",t)):(s.removeClass(n).css("background",""),s.addClass("jstree-themeicon-custom").css("background","url('"+t+"') center center no-repeat").attr("rel",t)),!1===n&&this.show_icon(e)),!0)},get_icon:function(e){return!(!(e=this.get_node(e))||e.id===v.jstree.root)&&e.icon},hide_icon:function(e){var t,i;if(v.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.hide_icon(e[t]);return!0}return!(!(e=this.get_node(e))||e===v.jstree.root)&&(e.icon=!1,this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(e){var t,i,r;if(v.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.show_icon(e[t]);return!0}return!(!(e=this.get_node(e))||e===v.jstree.root)&&(r=this.get_node(e,!0),e.icon=!r.length||r.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),e.icon||(e.icon=!0),r.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},v.vakata={},v.vakata.attributes=function(e,i){e=v(e)[0];var r=i?{}:[];return e&&e.attributes&&v.each(e.attributes,function(e,t){-1===v.inArray(t.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==t.value&&""!==v.vakata.trim(t.value)&&(i?r[t.name]=t.value:r.push(t.name))}),r},v.vakata.array_unique=function(e){for(var t=[],i,r,s,n={},i=0,s=e.length;i<s;i++)n[e[i]]===y&&(t.push(e[i]),n[e[i]]=!0);return t},v.vakata.array_remove=function(e,t){return e.splice(t,1),e},v.vakata.array_remove_item=function(e,t){var t=v.inArray(t,e);return-1!==t?v.vakata.array_remove(e,t):e},v.vakata.array_filter=function(e,t,i,r,s){if(e.filter)return e.filter(t,i);for(s in r=[],e)~~s+""==s+""&&0<=s&&t.call(i,e[s],+s,e)&&r.push(e[s]);return r},v.vakata.trim=function(e){return String.prototype.trim?String.prototype.trim.call(e.toString()):e.toString().replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},v.vakata.is_function=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},v.vakata.is_array=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Function.prototype.bind||(Function.prototype.bind=function(){var t=this,i=arguments[0],r=Array.prototype.slice.call(arguments,1);if("function"!=typeof t)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");return function(){var e=r.concat(Array.prototype.slice.call(arguments));return t.apply(i,e)}}),v.jstree.plugins.changed=function(e,n){var a=[];this.trigger=function(e,t){var i,r;if(t=t||{},"changed"===e.replace(".jstree","")){t.changed={selected:[],deselected:[]};for(var s={},i=0,r=a.length;i<r;i++)s[a[i]]=1;for(i=0,r=t.selected.length;i<r;i++)s[t.selected[i]]?s[t.selected[i]]=2:t.changed.selected.push(t.selected[i]);for(i=0,r=a.length;i<r;i++)1===s[a[i]]&&t.changed.deselected.push(a[i]);a=t.selected.slice()}n.trigger.call(this,e,t)},this.refresh=function(e,t){return a=[],n.refresh.apply(this,arguments)}};var l=x.createElement("I");if(l.className="jstree-icon jstree-checkbox",l.setAttribute("role","presentation"),v.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},v.jstree.plugins.checkbox=function(e,o){this.bind=function(){o.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")}.bind(this)).on("loading.jstree",function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()}.bind(this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)}.bind(this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",function(e,t){for(var i=this._model.data,r=i[t.parent],s=t.nodes,n,a,n=0,a=s.length;n<a;n++)i[s[n]].state.checked=i[s[n]].state.checked||i[s[n]].original&&i[s[n]].original.state&&i[s[n]].original.state.checked,i[s[n]].state.checked&&this._data.checkbox.selected.push(s[n])}.bind(this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",function(e,t){var i=this._model.data,r=i[t.parent],s=t.nodes,n=[],a,d,o,c,l,h,t=this.settings.checkbox.cascade,_=this.settings.checkbox.tie_selection;if(-1!==t.indexOf("down"))if(r.state[_?"selected":"checked"]){for(d=0,o=s.length;d<o;d++)i[s[d]].state[_?"selected":"checked"]=!0;this._data[_?"core":"checkbox"].selected=this._data[_?"core":"checkbox"].selected.concat(s)}else for(d=0,o=s.length;d<o;d++)if(i[s[d]].state[_?"selected":"checked"]){for(c=0,l=i[s[d]].children_d.length;c<l;c++)i[i[s[d]].children_d[c]].state[_?"selected":"checked"]=!0;this._data[_?"core":"checkbox"].selected=this._data[_?"core":"checkbox"].selected.concat(i[s[d]].children_d)}if(-1!==t.indexOf("up")){for(d=0,o=r.children_d.length;d<o;d++)i[r.children_d[d]].children.length||n.push(i[r.children_d[d]].parent);for(c=0,l=(n=v.vakata.array_unique(n)).length;c<l;c++){r=i[n[c]];while(r&&r.id!==v.jstree.root){for(d=a=0,o=r.children.length;d<o;d++)a+=i[r.children[d]].state[_?"selected":"checked"];if(a!==o)break;r.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(r.id),(h=this.get_node(r,!0))&&h.length&&h.children(".jstree-anchor").attr("aria-selected",!0).addClass(_?"jstree-clicked":"jstree-checked"),r=this.get_node(r.parent)}}}this._data[_?"core":"checkbox"].selected=v.vakata.array_unique(this._data[_?"core":"checkbox"].selected)}.bind(this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",function(e,t){var i=this,r=t.node,s=this._model.data,n=this.get_node(r.parent),a,d,o,c,t=this.settings.checkbox.cascade,l=this.settings.checkbox.tie_selection,h={},_=this._data[l?"core":"checkbox"].selected;for(a=0,d=_.length;a<d;a++)h[_[a]]=!0;if(-1!==t.indexOf("down"))for(var u=this._cascade_new_checked_state(r.id,!0),f=r.children_d.concat(r.id),a=0,d=f.length;a<d;a++)-1<u.indexOf(f[a])?h[f[a]]=!0:delete h[f[a]];if(-1!==t.indexOf("up"))while(n&&n.id!==v.jstree.root){for(a=o=0,d=n.children.length;a<d;a++)o+=s[n.children[a]].state[l?"selected":"checked"];if(o!==d)break;n.state[l?"selected":"checked"]=!0,h[n.id]=!0,(c=this.get_node(n,!0))&&c.length&&c.children(".jstree-anchor").attr("aria-selected",!0).addClass(l?"jstree-clicked":"jstree-checked"),n=this.get_node(n.parent)}for(a in _=[],h)h.hasOwnProperty(a)&&_.push(a);this._data[l?"core":"checkbox"].selected=_}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",function(e,t){for(var i=this.get_node(v.jstree.root),r=this._model.data,s,n,a,s=0,n=i.children_d.length;s<n;s++)(a=r[i.children_d[s]])&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1)}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",function(e,t){var i=this,r=t.node,s=this.get_node(r,!0),n,a,d,o=this.settings.checkbox.cascade,c=this.settings.checkbox.tie_selection,t=this._data[c?"core":"checkbox"].selected,l={},h=[],_=r.children_d.concat(r.id),u,t;if(-1!==o.indexOf("down")&&(u=this._cascade_new_checked_state(r.id,!1),t=v.vakata.array_filter(t,function(e){return-1===_.indexOf(e)||-1<u.indexOf(e)})),-1!==o.indexOf("up")&&-1===t.indexOf(r.id)){for(n=0,a=r.parents.length;n<a;n++)(d=this._model.data[r.parents[n]]).state[c?"selected":"checked"]=!1,d&&d.original&&d.original.state&&d.original.state.undetermined&&(d.original.state.undetermined=!1),(d=this.get_node(r.parents[n],!0))&&d.length&&d.children(".jstree-anchor").attr("aria-selected",!1).removeClass(c?"jstree-clicked":"jstree-checked");t=v.vakata.array_filter(t,function(e){return-1===r.parents.indexOf(e)})}this._data[c?"core":"checkbox"].selected=t}.bind(this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",function(e,t){var i=this.get_node(t.parent),r=this._model.data,s,n,a,d,o=this.settings.checkbox.tie_selection;while(i&&i.id!==v.jstree.root&&!i.state[o?"selected":"checked"]){for(s=a=0,n=i.children.length;s<n;s++)a+=r[i.children[s]].state[o?"selected":"checked"];if(!(0<n&&a===n))break;i.state[o?"selected":"checked"]=!0,this._data[o?"core":"checkbox"].selected.push(i.id),(d=this.get_node(i,!0))&&d.length&&d.children(".jstree-anchor").attr("aria-selected",!0).addClass(o?"jstree-clicked":"jstree-checked"),i=this.get_node(i.parent)}}.bind(this)).on("move_node.jstree",function(e,t){var i=t.is_multi,r=t.old_parent,t=this.get_node(t.parent),s=this._model.data,n,a,d,o,c,l=this.settings.checkbox.tie_selection;if(!i){n=this.get_node(r);while(n&&n.id!==v.jstree.root&&!n.state[l?"selected":"checked"]){for(d=a=0,o=n.children.length;d<o;d++)a+=s[n.children[d]].state[l?"selected":"checked"];if(!(0<o&&a===o))break;n.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(n.id),(c=this.get_node(n,!0))&&c.length&&c.children(".jstree-anchor").attr("aria-selected",!0).addClass(l?"jstree-clicked":"jstree-checked"),n=this.get_node(n.parent)}}n=t;while(n&&n.id!==v.jstree.root){for(d=a=0,o=n.children.length;d<o;d++)a+=s[n.children[d]].state[l?"selected":"checked"];if(a===o)n.state[l?"selected":"checked"]||(n.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(n.id),(c=this.get_node(n,!0))&&c.length&&c.children(".jstree-anchor").attr("aria-selected",!0).addClass(l?"jstree-clicked":"jstree-checked"));else{if(!n.state[l?"selected":"checked"])break;n.state[l?"selected":"checked"]=!1,this._data[l?"core":"checkbox"].selected=v.vakata.array_remove_item(this._data[l?"core":"checkbox"].selected,n.id),(c=this.get_node(n,!0))&&c.length&&c.children(".jstree-anchor").attr("aria-selected",!1).removeClass(l?"jstree-clicked":"jstree-checked")}n=this.get_node(n.parent)}}.bind(this))},this.get_undetermined=function(e){if(-1===this.settings.checkbox.cascade.indexOf("undetermined"))return[];for(var i,r,s,n,a={},d=this._model.data,t=this.settings.checkbox.tie_selection,o=this._data[t?"core":"checkbox"].selected,c=[],l=this,h=[],i=0,r=o.length;i<r;i++)if(d[o[i]]&&d[o[i]].parents)for(s=0,n=d[o[i]].parents.length;s<n;s++){if(a[d[o[i]].parents[s]]!==y)break;d[o[i]].parents[s]!==v.jstree.root&&(a[d[o[i]].parents[s]]=!0,c.push(d[o[i]].parents[s]))}for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var e=l.get_node(this),t;if(e)if(e.state.loaded){for(i=0,r=e.children_d.length;i<r;i++)if(!(t=d[e.children_d[i]]).state.loaded&&t.original&&t.original.state&&t.original.state.undetermined&&!0===t.original.state.undetermined)for(a[t.id]===y&&t.id!==v.jstree.root&&(a[t.id]=!0,c.push(t.id)),s=0,n=t.parents.length;s<n;s++)a[t.parents[s]]===y&&t.parents[s]!==v.jstree.root&&(a[t.parents[s]]=!0,c.push(t.parents[s]))}else if(e.original&&e.original.state&&e.original.state.undetermined&&!0===e.original.state.undetermined)for(a[e.id]===y&&e.id!==v.jstree.root&&(a[e.id]=!0,c.push(e.id)),s=0,n=e.parents.length;s<n;s++)a[e.parents[s]]===y&&e.parents[s]!==v.jstree.root&&(a[e.parents[s]]=!0,c.push(e.parents[s]))}),i=0,r=c.length;i<r;i++)d[c[i]].state[t?"selected":"checked"]||h.push(e?d[c[i]]:c[i]);return h},this._undetermined=function(){if(null!==this.element){var e=this.get_undetermined(!1),t,i,r;for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),t=0,i=e.length;t<i;t++)(r=this.get_node(e[t],!0))&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(e,t,i,r){if(e=o.redraw_node.apply(this,arguments)){for(var s,n,a=null,d=null,s=0,n=e.childNodes.length;s<n;s++)if(e.childNodes[s]&&e.childNodes[s].className&&-1!==e.childNodes[s].className.indexOf("jstree-anchor")){a=e.childNodes[s];break}a&&(!this.settings.checkbox.tie_selection&&this._model.data[e.id].state.checked&&(a.className+=" jstree-checked"),d=l.cloneNode(!1),this._model.data[e.id].state.checkbox_disabled&&(d.className+=" jstree-checkbox-disabled"),a.insertBefore(d,a.childNodes[0]))}return i||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)),e},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(e){e=this.get_node(e);var t=this.settings.checkbox.cascade,i,r,s=this.settings.checkbox.tie_selection,n=this._data[s?"core":"checkbox"].selected,a=this._model.data;if(!e||!0===e.state[s?"selected":"checked"]||-1===t.indexOf("undetermined")||-1===t.indexOf("down")&&-1===t.indexOf("up"))return!1;if(!e.state.loaded&&!0===e.original.state.undetermined)return!0;for(i=0,r=e.children_d.length;i<r;i++)if(-1!==v.inArray(e.children_d[i],n)||!a[e.children_d[i]].state.loaded&&a[e.children_d[i]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(e){var t,i,r;if(v.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.disable_checkbox(e[t]);return!0}if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;r=this.get_node(e,!0),e.state.checkbox_disabled||(e.state.checkbox_disabled=!0,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:e}))},this.enable_checkbox=function(e){var t,i,r;if(v.vakata.is_array(e)){for(t=0,i=(e=e.slice()).length;t<i;t++)this.enable_checkbox(e[t]);return!0}if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;r=this.get_node(e,!0),e.state.checkbox_disabled&&(e.state.checkbox_disabled=!1,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:e}))},this.activate_node=function(e,t){return!v(t.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||v(t.target).hasClass("jstree-checkbox"))&&(t.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!v(t.target).hasClass("jstree-checkbox")?o.activate_node.call(this,e,t):!this.is_disabled(e)&&(this.is_checked(e)?this.uncheck_node(e,t):this.check_node(e,t),void this.trigger("activate_node",{node:this.get_node(e)})))},this.delete_node=function(e){if(this.settings.checkbox.tie_selection||v.vakata.is_array(e))return o.delete_node.call(this,e);var t,i,r,s=!1;if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;for((t=e.children_d.concat([])).push(e.id),i=0,r=t.length;i<r;i++)if(this._model.data[t[i]].state.checked){s=!0;break}return s&&(this._data.checkbox.selected=v.vakata.array_filter(this._data.checkbox.selected,function(e){return-1===v.inArray(e,t)})),o.delete_node.call(this,e)},this._cascade_new_checked_state=function(e,t){var i=this,r=this.settings.checkbox.tie_selection,s=this._model.data[e],n=[],a=[],d,o,c;if(!this.settings.checkbox.cascade_to_disabled&&s.state.disabled||!this.settings.checkbox.cascade_to_hidden&&s.state.hidden)c=this.get_checked_descendants(e),s.state[r?"selected":"checked"]&&c.push(s.id),n=n.concat(c);else{if(s.children)for(d=0,o=s.children.length;d<o;d++){var l=s.children[d],c=i._cascade_new_checked_state(l,t),n=n.concat(c);-1<c.indexOf(l)&&a.push(l)}var h=i.get_node(s,!0),e=0<a.length&&a.length<s.children.length;s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=e),!e&&t&&a.length===s.children.length?(s.state[r?"selected":"checked"]=t,n.push(s.id),h.children(".jstree-anchor").attr("aria-selected",!0).addClass(r?"jstree-clicked":"jstree-checked")):(s.state[r?"selected":"checked"]=!1,h.children(".jstree-anchor").attr("aria-selected",!1).removeClass(r?"jstree-clicked":"jstree-checked"))}return n},this.get_checked_descendants=function(e){var t=this,i=t.settings.checkbox.tie_selection,e=t._model.data[e];return v.vakata.array_filter(e.children_d,function(e){return t._model.data[e].state[i?"selected":"checked"]})},this.check_node=function(e,t){if(this.settings.checkbox.tie_selection)return this.select_node(e,!1,!0,t);var i,r,s,n;if(v.vakata.is_array(e)){for(r=0,s=(e=e.slice()).length;r<s;r++)this.check_node(e[r],t);return!0}if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;i=this.get_node(e,!0),e.state.checked||(e.state.checked=!0,this._data.checkbox.selected.push(e.id),i&&i.length&&i.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:e,selected:this._data.checkbox.selected,event:t}))},this.uncheck_node=function(e,t){if(this.settings.checkbox.tie_selection)return this.deselect_node(e,!1,t);var i,r,s;if(v.vakata.is_array(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.uncheck_node(e[i],t);return!0}if(!(e=this.get_node(e))||e.id===v.jstree.root)return!1;s=this.get_node(e,!0),e.state.checked&&(e.state.checked=!1,this._data.checkbox.selected=v.vakata.array_remove_item(this._data.checkbox.selected,e.id),s.length&&s.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:e,selected:this._data.checkbox.selected,event:t}))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var e=this._data.checkbox.selected.concat([]),t,i;for(this._data.checkbox.selected=this._model.data[v.jstree.root].children_d.concat(),t=0,i=this._data.checkbox.selected.length;t<i;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();for(var e=this._data.checkbox.selected.concat([]),t,i,t=0,i=this._data.checkbox.selected.length;t<i;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:e})},this.is_checked=function(e){return this.settings.checkbox.tie_selection?this.is_selected(e):!(!(e=this.get_node(e))||e.id===v.jstree.root)&&e.state.checked},this.get_checked=function(e){return this.settings.checkbox.tie_selection?this.get_selected(e):e?v.map(this._data.checkbox.selected,function(e){return this.get_node(e)}.bind(this)):this._data.checkbox.selected.slice()},this.get_top_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_top_selected(e);for(var t=this.get_checked(!0),i={},r,s,n,a,r=0,s=t.length;r<s;r++)i[t[r].id]=t[r];for(r=0,s=t.length;r<s;r++)for(n=0,a=t[r].children_d.length;n<a;n++)i[t[r].children_d[n]]&&delete i[t[r].children_d[n]];for(r in t=[],i)i.hasOwnProperty(r)&&t.push(r);return e?v.map(t,function(e){return this.get_node(e)}.bind(this)):t},this.get_bottom_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(e);for(var t=this.get_checked(!0),i=[],r,s,r=0,s=t.length;r<s;r++)t[r].children.length||i.push(t[r].id);return e?v.map(i,function(e){return this.get_node(e)}.bind(this)):i},this.load_node=function(e,t){var i,r,s,n,a,d;if(!v.vakata.is_array(e)&&!this.settings.checkbox.tie_selection&&(d=this.get_node(e))&&d.state.loaded)for(i=0,r=d.children_d.length;i<r;i++)this._model.data[d.children_d[i]].state.checked&&(this._data.checkbox.selected=v.vakata.array_remove_item(this._data.checkbox.selected,d.children_d[i]));return o.load_node.apply(this,arguments)},this.get_state=function(){var e=o.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection||(e.checkbox=this._data.checkbox.selected.slice()),e},this.set_state=function(e,t){var i=o.set_state.apply(this,arguments),r;return i&&e.checkbox?(this.settings.checkbox.tie_selection||(this.uncheck_all(),r=this,v.each(e.checkbox,function(e,t){r.check_node(t)})),delete e.checkbox,this.set_state(e,t),!1):i},this.refresh=function(e,t){return this.settings.checkbox.tie_selection&&(this._data.checkbox.selected=[]),o.refresh.apply(this,arguments)}},v.jstree.defaults.massload=null,v.jstree.plugins.massload=function(e,l){this.init=function(e,t){this._data.massload={},l.init.call(this,e,t)},this._load_nodes=function(n,a,d,o){var e=this.settings.massload,t=[],i=this._model.data,r,s,c;if(!d){for(r=0,s=n.length;r<s;r++)i[n[r]]&&(i[n[r]].state.loaded||i[n[r]].state.failed)&&!o||(t.push(n[r]),(c=this.get_node(n[r],!0))&&c.length&&c.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},t.length){if(v.vakata.is_function(e))return e.call(this,t,function(e){var t,i;if(e)for(t in e)e.hasOwnProperty(t)&&(this._data.massload[t]=e[t]);for(t=0,i=n.length;t<i;t++)(c=this.get_node(n[t],!0))&&c.length&&c.removeClass("jstree-loading").attr("aria-busy",!1);l._load_nodes.call(this,n,a,d,o)}.bind(this));if("object"==typeof e&&e&&e.url)return e=v.extend(!0,{},e),v.vakata.is_function(e.url)&&(e.url=e.url.call(this,t)),v.vakata.is_function(e.data)&&(e.data=e.data.call(this,t)),v.ajax(e).done(function(e,t,i){var r,s;if(e)for(r in e)e.hasOwnProperty(r)&&(this._data.massload[r]=e[r]);for(r=0,s=n.length;r<s;r++)(c=this.get_node(n[r],!0))&&c.length&&c.removeClass("jstree-loading").attr("aria-busy",!1);l._load_nodes.call(this,n,a,d,o)}.bind(this)).fail(function(e){l._load_nodes.call(this,n,a,d,o)}.bind(this))}}return l._load_nodes.call(this,n,a,d,o)},this._load_node=function(e,t){var i=this._data.massload[e.id],r=null,i;return i?(r=this["string"==typeof i?"_append_html_data":"_append_json_data"](e,"string"==typeof i?v(v.parseHTML(i)).filter(function(){return 3!==this.nodeType}):i,function(e){t.call(this,e)}),(i=this.get_node(e.id,!0))&&i.length&&i.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[e.id],r):l._load_node.call(this,e,t)}},v.jstree.defaults.types={default:{}},v.jstree.defaults.types[v.jstree.root]={},v.jstree.plugins.types=function(e,l){this.init=function(e,t){var i,r;if(t&&t.types&&t.types.default)for(i in t.types)if("default"!==i&&i!==v.jstree.root&&t.types.hasOwnProperty(i))for(r in t.types.default)t.types.default.hasOwnProperty(r)&&t.types[i][r]===y&&(t.types[i][r]=t.types.default[r]);l.init.call(this,e,t),this._model.data[v.jstree.root].type=v.jstree.root},this.refresh=function(e,t){l.refresh.call(this,e,t),this._model.data[v.jstree.root].type=v.jstree.root},this.bind=function(){this.element.on("model.jstree",function(e,t){for(var i=this._model.data,r=t.nodes,s=this.settings.types,n,a,d="default",o,n=0,a=r.length;n<a;n++){if(d="default",i[r[n]].original&&i[r[n]].original.type&&s[i[r[n]].original.type]&&(d=i[r[n]].original.type),i[r[n]].data&&i[r[n]].data.jstree&&i[r[n]].data.jstree.type&&s[i[r[n]].data.jstree.type]&&(d=i[r[n]].data.jstree.type),i[r[n]].type=d,!0===i[r[n]].icon&&s[d].icon!==y&&(i[r[n]].icon=s[d].icon),s[d].li_attr!==y&&"object"==typeof s[d].li_attr)for(o in s[d].li_attr)s[d].li_attr.hasOwnProperty(o)&&"id"!==o&&(i[r[n]].li_attr[o]===y?i[r[n]].li_attr[o]=s[d].li_attr[o]:"class"===o&&(i[r[n]].li_attr.class=s[d].li_attr.class+" "+i[r[n]].li_attr.class));if(s[d].a_attr!==y&&"object"==typeof s[d].a_attr)for(o in s[d].a_attr)s[d].a_attr.hasOwnProperty(o)&&"id"!==o&&(i[r[n]].a_attr[o]===y?i[r[n]].a_attr[o]=s[d].a_attr[o]:"href"===o&&"#"===i[r[n]].a_attr[o]?i[r[n]].a_attr.href=s[d].a_attr.href:"class"===o&&(i[r[n]].a_attr.class=s[d].a_attr.class+" "+i[r[n]].a_attr.class))}i[v.jstree.root].type=v.jstree.root}.bind(this)),l.bind.call(this)},this.get_json=function(e,t,i){var r,s,n=this._model.data,a=t?v.extend(!0,{},t,{no_id:!1}):{},d=l.get_json.call(this,e,a,i);if(!1===d)return!1;if(v.vakata.is_array(d))for(r=0,s=d.length;r<s;r++)d[r].type=(d[r].id||0===d[r].id)&&n[d[r].id]&&n[d[r].id].type?n[d[r].id].type:"default",t&&t.no_id&&(delete d[r].id,d[r].li_attr&&d[r].li_attr.id&&delete d[r].li_attr.id,d[r].a_attr&&d[r].a_attr.id&&delete d[r].a_attr.id);else d.type=(d.id||0===d.id)&&n[d.id]&&n[d.id].type?n[d.id].type:"default",t&&t.no_id&&(d=this._delete_ids(d));return d},this._delete_ids=function(e){if(v.vakata.is_array(e)){for(var t=0,i=e.length;t<i;t++)e[t]=this._delete_ids(e[t]);return e}return delete e.id,e.li_attr&&e.li_attr.id&&delete e.li_attr.id,e.a_attr&&e.a_attr.id&&delete e.a_attr.id,e.children&&v.vakata.is_array(e.children)&&(e.children=this._delete_ids(e.children)),e},this.check=function(e,t,i,r,s){if(!1===l.check.call(this,e,t,i,r,s))return!1;t=t&&(t.id||0===t.id)?t:this.get_node(t),i=i&&(i.id||0===i.id)?i:this.get_node(i);var n,a,d,o,c,n=(n=t&&(t.id||0===t.id)?s&&s.origin?s.origin:v.jstree.reference(t.id):null)&&n._model&&n._model.data?n._model.data:null;switch(e){case"create_node":case"move_node":case"copy_node":if("move_node"!==e||-1===v.inArray(t.id,i.children)){if((a=this.get_rules(i)).max_children!==y&&-1!==a.max_children&&a.max_children===i.children.length)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id&&0!==t.id)&&t.id,par:!(!i||!i.id&&0!==i.id)&&i.id})});if(a.valid_children!==y&&-1!==a.valid_children&&-1===v.inArray(t.type||"default",a.valid_children))return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id&&0!==t.id)&&t.id,par:!(!i||!i.id&&0!==i.id)&&i.id})});if(n&&t.children_d&&t.parents){for(o=d=0,c=t.children_d.length;o<c;o++)d=Math.max(d,n[t.children_d[o]].parents.length);d=d-t.parents.length+1}(d<=0||d===y)&&(d=1);do{if(a.max_depth!==y&&-1!==a.max_depth&&a.max_depth<d)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!t||!t.id&&0!==t.id)&&t.id,par:!(!i||!i.id&&0!==i.id)&&i.id})});i=this.get_node(i.parent),a=this.get_rules(i),d++}while(i)}}return!0},this.get_rules=function(e){if(!(e=this.get_node(e)))return!1;var e=this.get_type(e,!0);return e.max_depth===y&&(e.max_depth=-1),e.max_children===y&&(e.max_children=-1),e.valid_children===y&&(e.valid_children=-1),e},this.get_type=function(e,t){return!!(e=this.get_node(e))&&(t?v.extend({type:e.type},this.settings.types[e.type]):e.type)},this.set_type=function(e,t){var i=this._model.data,r,s,n,a,d,o,c,l;if(v.vakata.is_array(e)){for(s=0,n=(e=e.slice()).length;s<n;s++)this.set_type(e[s],t);return!0}if(r=this.settings.types,e=this.get_node(e),!r[t]||!e)return!1;if((c=this.get_node(e,!0))&&c.length&&(l=c.children(".jstree-anchor")),a=e.type,d=this.get_icon(e),e.type=t,!0!==d&&r[a]&&(r[a].icon===y||d!==r[a].icon)||this.set_icon(e,r[t].icon===y||r[t].icon),r[a]&&r[a].li_attr!==y&&"object"==typeof r[a].li_attr)for(o in r[a].li_attr)r[a].li_attr.hasOwnProperty(o)&&"id"!==o&&("class"===o?(i[e.id].li_attr.class=(i[e.id].li_attr.class||"").replace(r[a].li_attr[o],""),c&&c.removeClass(r[a].li_attr[o])):i[e.id].li_attr[o]===r[a].li_attr[o]&&(i[e.id].li_attr[o]=null,c&&c.removeAttr(o)));if(r[a]&&r[a].a_attr!==y&&"object"==typeof r[a].a_attr)for(o in r[a].a_attr)r[a].a_attr.hasOwnProperty(o)&&"id"!==o&&("class"===o?(i[e.id].a_attr.class=(i[e.id].a_attr.class||"").replace(r[a].a_attr[o],""),l&&l.removeClass(r[a].a_attr[o])):i[e.id].a_attr[o]===r[a].a_attr[o]&&("href"===o?(i[e.id].a_attr[o]="#",l&&l.attr("href","#")):(delete i[e.id].a_attr[o],l&&l.removeAttr(o))));if(r[t].li_attr!==y&&"object"==typeof r[t].li_attr)for(o in r[t].li_attr)r[t].li_attr.hasOwnProperty(o)&&"id"!==o&&(i[e.id].li_attr[o]===y?(i[e.id].li_attr[o]=r[t].li_attr[o],c&&("class"===o?c.addClass(r[t].li_attr[o]):c.attr(o,r[t].li_attr[o]))):"class"===o&&(i[e.id].li_attr.class=r[t].li_attr[o]+" "+i[e.id].li_attr.class,c&&c.addClass(r[t].li_attr[o])));if(r[t].a_attr!==y&&"object"==typeof r[t].a_attr)for(o in r[t].a_attr)r[t].a_attr.hasOwnProperty(o)&&"id"!==o&&(i[e.id].a_attr[o]===y?(i[e.id].a_attr[o]=r[t].a_attr[o],l&&("class"===o?l.addClass(r[t].a_attr[o]):l.attr(o,r[t].a_attr[o]))):"href"===o&&"#"===i[e.id].a_attr[o]?(i[e.id].a_attr.href=r[t].a_attr.href,l&&l.attr("href",r[t].a_attr.href)):"class"===o&&(i[e.id].a_attr.class=r[t].a_attr.class+" "+i[e.id].a_attr.class,l&&l.addClass(r[t].a_attr[o])));return!0}},window.customElements&&Object&&Object.create){var e=Object.create(HTMLElement.prototype);e.createdCallback=function(){var e={core:{},plugins:[]},t;for(t in v.jstree.plugins)v.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(e.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(e[t]=JSON.parse(this.getAttribute(t))));for(t in v.jstree.defaults.core)v.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(e.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));v(this).jstree(e)};try{window.customElements.define("vakata-jstree",function(){},{prototype:e})}catch(e){}}}});